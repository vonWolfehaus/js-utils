(function(){var t=this,e=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0},i=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+""+Math.floor(1e3*Math.random()),this.sortArray=[],this.getNode=function(t){return this.objToNodeMap[t.uniqueID]},this.addNode=function(t){var n=new e;if(!t.uniqueID)try{t.uniqueID=i.generateID(),console.log("New ID: "+t.uniqueID)}catch(s){return console.error("[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier"),null}return n.obj=t,n.free=!1,this.objToNodeMap[t.uniqueID]=n,n},this.swapObjects=function(t,e){this.objToNodeMap[t.obj.uniqueID]=null,this.objToNodeMap[e.uniqueID]=t,t.obj=e},this.add=function(t){var e=this.objToNodeMap[t.uniqueID];if(e){if(e.free===!1)return;e.obj=t,e.free=!1,e.next=null,e.prev=null}else e=this.addNode(t);if(this.first){if(!this.last)throw new Error("[LinkedList.add] No last in the list -- that shouldn't happen here");this.last.next=e,e.prev=this.last,this.last=e,e.next=null}else this.first=e,this.last=e,e.next=null,e.prev=null;this.length++,this.showDebug&&this.dump("after add")},this.has=function(t){return!!this.objToNodeMap[t.uniqueID]},this.moveUp=function(t){this.dump("before move up");var e=this.getNode(t);if(!e)throw"Oops, trying to move an object that isn't in the list";if(e.prev){var i=e.prev,n=i.prev;e==this.last&&(this.last=i);var s=e.next;n&&(n.next=e),e.next=i,e.prev=i.prev,i.next=s,i.prev=e,this.first==i&&(this.first=e)}},this.moveDown=function(t){var e=this.getNode(t);if(!e)throw"Oops, trying to move an object that isn't in the list";if(e.next){var i=e.next;this.moveUp(i.obj),this.last==i&&(this.last=e)}},this.sort=function(t){var e,i,n=this.sortArray,s=this.first;for(n.length=0;s;)n.push(s.obj),s=s.next;for(this.clear(),n.sort(t),i=n.length,e=0;i>e;e++)this.add(n[e])},this.remove=function(t){var e=this.getNode(t);return!e||e.free?!1:(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.prev||(this.first=e.next),e.next||(this.last=e.prev),e.free=!0,e.prev=null,e.next=null,this.length--,!0)},this.shift=function(){var t=this.first;return 0===this.length?null:(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.first=t.next,t.next||(this.last=null),t.free=!0,t.prev=null,t.next=null,this.length--,t.obj)},this.pop=function(){var t=this.last;return 0===this.length?null:(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),this.last=t.prev,t.prev||(this.first=null),t.free=!0,t.prev=null,t.next=null,this.length--,t.obj)},this.concat=function(t){for(var e=t.first;e;)this.add(e.obj),e=e.next},this.clear=function(){for(var t=this.first;t;)t.free=!0,t=t.next;this.first=null,this.length=0},this.dispose=function(){for(var t=this.first;t;)t.obj=null,t=t.next;this.first=null,this.objToNodeMap=null},this.dump=function(t){console.log("===================="+t+"=====================");for(var e=this.first;e;)console.log("{"+e.obj.toString()+"} previous="+(e.prev?e.prev.obj:"NULL")),e=e.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}};i.generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.LinkedList=i):"undefined"!=typeof define&&define.amd?define(i):t.LinkedList=i}).call(this);