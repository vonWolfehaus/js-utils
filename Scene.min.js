(function(){var t=this,e=function(t,e){var i={element:document.body,alpha:!1,antialias:!0,clearColor:"#fff",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:"PerspectiveCamera",cameraPosition:null},o={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(von.utils.merge(i,t),von.utils.merge(o,e),this.renderer=new THREE.WebGLRenderer({alpha:i.alpha,antialias:i.antialias}),this.renderer.setClearColor(i.clearColor,0),this.renderer.sortObjects=i.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=4,this.container=new THREE.Scene,this.container.fog=i.fog,this.container.add(new THREE.AmbientLight(12303291)),i.lightPosition||i.light.position.set(2,3,1).normalize(),this.container.add(i.light),this.light=i.light,"OrthographicCamera"===i.cameraType){var h=window.innerWidth/this.orthoZoom,a=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(h/-2,h/2,a/2,a/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!e,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=o.minDistance,this.controls.maxDistance=o.maxDistance,this.controls.zoomSpeed=o.zoomSpeed,this.controls.noZoom=o.noZoom),i.cameraPosition&&this.camera.position.copy(i.cameraPosition),window.addEventListener("resize",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,"OrthographicCamera"===this.camera.type){var t=this.width/this.orthoZoom,e=this.height/this.orthoZoom;this.camera.left=t/-2,this.camera.right=t/2,this.camera.top=e/2,this.camera.bottom=e/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(i.element)};e.prototype={enableShadows:function(){this.light.castShadow=!0,this.light.shadowDarkness=.4,this.light.shadowBias=1e-4,this.light.shadowMapWidth=2048,this.light.shadowMapHeight=2048,this.renderer.shadowMapEnabled=!0,this.renderer.shadowMapType=THREE.PCFShadowMap},attachTo:function(t){t.style.width=this.width+"px",t.style.height=this.height+"px",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),t.appendChild(this.renderer.domElement)},add:function(t){this.container.add(t)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)return void(this.orthoZoom=0);var t=this.width/this.orthoZoom,e=this.height/this.orthoZoom;this.camera.left=t/-2,this.camera.right=t/2,this.camera.top=e/2,this.camera.bottom=e/-2,this.camera.updateProjectionMatrix()},focusOn:function(t){this.camera.lookAt(t.position)},createGround:function(t,e,i){var o=new THREE.PlaneBufferGeometry(t,e,1,1),h=new THREE.MeshPhongMaterial({color:i||16777215});h.ambient=h.color;var a=new THREE.Mesh(o,h);return a.rotation.x=-Math.PI/2,a.castShadow=!1,a.receiveShadow=!0,a.scale.set(2,2,2),this.container.add(a),a}},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.Scene=e):"undefined"!=typeof define&&define.amd?define(e):t.Scene=e}).call(this);